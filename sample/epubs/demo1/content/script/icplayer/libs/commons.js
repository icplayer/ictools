(function(d){var a={validateBoolean:function(a){return"True"===a},validateInteger:function(b){var c={isValid:!1,value:NaN};if(a.isStringEmpty(b))return c;b=parseInt(b,10);if(isNaN(b))return c;c.isValid=!0;c.value=b;return c},validatePositiveInteger:function(a){a=this.validateInteger(a);return!a.isValid?a:1>a.value?{isValid:!1}:a},validateIntegerInRange:function(a,c,e){a=this.validateInteger(a);if(!a.isValid)return a;e||(e=0);return a.value<e||a.value>c?{isValid:!1}:a},validateFloat:function(b,c){var e=
{isValid:!1,value:NaN,parsedValue:NaN};if(a.isStringEmpty(b))return e;var d=parseFloat(b);if(isNaN(d))return e;c||(c=2);e.isValid=!0;e.value=d.toFixed(c);e.parsedValue=parseFloat(e.value);return e},validateFloatInRange:function(a,c,e,d){d||(d=2);a=this.validateFloat(a,d);if(!a.isValid)return a;e||(e=0);e=parseFloat(e.toFixed(d));c=parseFloat(c.toFixed(d));return a.value<e||a.value>c?{isValid:!1}:a},validateOption:function(a,c){for(var e in a)if(Object.prototype.hasOwnProperty.call(a,e)&&e===c)return a[e];
return a[a.DEFAULT]},validateColor:function(a,c){c||(c="#FFFFFF");if(!a)return{isValid:!1,color:c};var e=a.match(/#[0-9a-fA-F]+/),d;return(d=(d=!e||null===e||1!=e.length)||7!=e[0].length)?{isValid:!1,color:c}:{isValid:!0,color:a}},isStringEmpty:function(a){return void 0===a||""===a},isStringWithPrefixEmpty:function(b,c){return a.isStringEmpty(b)?!0:b===c},isArrayElementEmpty:function(b){if(!b)return!0;for(var c in b)if(Object.prototype.hasOwnProperty.call(b,c)&&!a.isStringEmpty(b[c]))return!1;return!0},
isArrayEmpty:function(b){return!b?!0:1===b.length&&a.isArrayElementEmpty(b[0])},removeDuplicatesFromArray:function(a){if(0===a.length)return[];for(var c=[],e=0;e<a.length-1;e++)a[e+1]!==a[e]&&c.push(a[e]);c.push(a[a.length-1]);return c}};d.ModelValidationUtils=a})(window);(function(d){d.LoadingScreen={screens:[],create:function(a){if(a){var a=$(a),b=a.width(),c=a.height(),e=Math.floor(1E3*Math.random())+"-"+Math.floor(1E3*Math.random()),d=$(document.createElement("img"));d.attr({src:"http://www.lorepo.com/media/images/loading.gif",alt:"Loading...",id:e,position:"absolute",display:"none",border:0,padding:0,margin:0});a.append(d);d.show();d.css({top:(c-d.height())/2+"px",left:(b-d.width())/2+"px"}).hide();this.screens.push({id:e,$element:d,counter:0});return e}},getScreen:function(a){for(var b=
0,c=this.screens.length;b<c;b++)if(this.screens[b].id===a)return b;return-1},show:function(a){a=this.getScreen(a);-1!==a&&(this.screens[a].counter++,this.screens[a].$element.show())},hide:function(a){a=this.getScreen(a);-1!==a&&(0<this.screens[a].counter&&this.screens[a].counter--,0===this.screens[a].counter&&this.screens[a].$element.hide())}}})(window);(function(d){d.DOMOperationsUtils={getOuterDimensions:function(a){a=$(a);return{border:{top:parseInt(a.css("border-top-width"),10),bottom:parseInt(a.css("border-bottom-width"),10),left:parseInt(a.css("border-left-width"),10),right:parseInt(a.css("border-right-width"),10)},margin:{top:parseInt(a.css("margin-top"),10),bottom:parseInt(a.css("margin-bottom"),10),left:parseInt(a.css("margin-left"),10),right:parseInt(a.css("margin-right"),10)},padding:{top:parseInt(a.css("padding-top"),10),bottom:parseInt(a.css("padding-bottom"),
10),left:parseInt(a.css("padding-left"),10),right:parseInt(a.css("padding-right"),10)}}},calculateOuterDistances:function(a){var b=a.border.top+a.border.bottom,b=b+(a.margin.top+a.margin.bottom),b=b+(a.padding.top+a.padding.bottom),c=a.border.left+a.border.right,c=c+(a.margin.left+a.margin.right),c=c+(a.padding.left+a.padding.right);return{vertical:b,horizontal:c}},calculateReducedSize:function(a,b){var c=DOMOperationsUtils.getOuterDimensions(b),c=DOMOperationsUtils.calculateOuterDistances(c);return{width:$(a).width()-
c.horizontal,height:$(a).height()-c.vertical}},setReducedSize:function(a,b){var c=DOMOperationsUtils.calculateReducedSize(a,b);$(b).css({width:c.width+"px",height:c.height+"px"});return c},showErrorMessage:function(a,b,c){$(a).html(b[c])},getResourceFullPath:function(a,b){return!a||!b?void 0:a.getStaticFilesPath()+b}}})(window);(function(d){d.Serialization={serialize:function(a){if(a){var b="";$.each(a,function(a,e){var d=typeof e;if("object"===d&&$.isArray(e)){var d="array",f="";$.each(e,function(a){f+=this+"-"+typeof e[a]+","});e=f=f.slice(0,-1)}b+="["+a+":"+d+":"+e+"]"});return b}},deserialize:function(a){if(a){var b={};if(a=a.match(/[\w]+:[\w-]+:[\w,.\- ]+/g)){for(var c=0;c<a.length;c++){var e=a[c].split(":");b[e[0]]=this.convert(e[2],e[1])}return b}}},convert:function(a,b){if(a&&b)switch(b){case "string":return a;case "number":return this.isInteger(a)?
parseInt(a):parseFloat(a);case "boolean":return"true"==a;case "array":return this.convertArray(a);default:return"This type of value is unrecognized."}},convertArray:function(a){for(var a=a.split(","),b=[],c=0;c<a.length;c++){var e=a[c].split("-");b.push(this.convert(e[0].trim(),e[1]))}return b},isInteger:function(a){return 0===a%1&&null!=a}}})(window);(function(d){d.Watermark={defaultOptions:{size:100,opacity:1,color:"#000000"},validateOptions:function(a){if(!a)return $.extend({},this.defaultOptions);var b=$.extend({},a);ModelValidationUtils.validatePositiveInteger(a.size).isValid||(b.size=this.defaultOptions.size);ModelValidationUtils.validateFloatInRange(a.opacity,1,0,2).isValid||(b.opacity=this.defaultOptions.opacity);ModelValidationUtils.validateColor(a.color,this.defaultOptions.color).isValid||(b.color=this.defaultOptions.color);return b},
draw:function(a,b){var c=$(a),e=$(document.createElement("canvas"));c.html(e);b=this.validateOptions(b);e.attr({width:b.size,height:b.size});e.rotateCanvas({x:b.size/2,y:b.size/2,angle:90}).drawArc({strokeWidth:1,strokeStyle:b.color,fillStyle:b.color,x:b.size/2,y:b.size/2,radius:b.size/2-1,opacity:b.opacity}).drawLine({strokeWidth:1,strokeStyle:"#FFF",fillStyle:"#FFF",rounded:!0,x1:b.size/2,y1:0.17*b.size,x2:b.size-0.2*b.size,y2:b.size-0.33*b.size,x3:0.2*b.size,y3:b.size-0.33*b.size,x4:b.size/2,y4:0.17*
b.size,opacity:b.opacity})}}})(window);(function(d){d.Helpers={splitLines:function(a){return a.split(/[\n\r]+/)},alertErrorMessage:function(a,b){var c=b+"\n\n";a.name&&(c+="["+a.name+"] ");c+=a.message?a.message:a;alert(c)}}})(window);(function(d){d.MobileUtils={isMobileUserAgent:function(a){return void 0===a||!a?!1:a.match(/Android/i)||a.match(/BlackBerry/i)||a.match(/iPhone|iPad|iPod/i)||a.match(/IEMobile/i)||a.match(/Opera Mini/i)?!0:!1},isSafariMobile:function(a){return void 0===a||!a?!1:a.match(/iPhone|iPad|iPod/i)?!0:!1}}})(window);(function(d){d.Commands={dispatch:function(a,b,c,e){var d,f;for(f in a)Object.prototype.hasOwnProperty.call(a,f)&&f.toLowerCase()===b&&a[f]&&(d=a[f].call(e,c));return d}};d.CommandsQueueFactory={create:function(a){return new d.CommandsQueue(a)}};d.CommandsQueueTask=function(a,b){this.name=a;this.params=b};d.CommandsQueue=function(a){this.module=a;this.queue=[]};d.CommandsQueue.prototype.addTask=function(a,b){var c=new d.CommandsQueueTask(a,b);this.queue.push(c)};d.CommandsQueue.prototype.getTask=
function(){return this.isQueueEmpty()?null:this.queue.splice(0,1)[0]};d.CommandsQueue.prototype.getAllTasks=function(){return this.queue};d.CommandsQueue.prototype.executeTask=function(){var a=this.getTask();a&&this.module.executeCommand(a.name.toLowerCase(),a.params)};d.CommandsQueue.prototype.executeAllTasks=function(){for(;!this.isQueueEmpty();)this.executeTask()};d.CommandsQueue.prototype.getTasksCount=function(){return this.queue.length};d.CommandsQueue.prototype.isQueueEmpty=function(){return 0===
this.queue.length}})(window);(function(d){d.ImageViewer={validateSound:function(a){var b=[];if(a&&$.isArray(a))for(var c=0;c<a.length;c++){var e=ModelValidationUtils.isStringWithPrefixEmpty(a[c]["MP3 sound"],"/file/"),d=ModelValidationUtils.isStringWithPrefixEmpty(a[c]["AAC sound"],"/file/"),f=ModelValidationUtils.isStringWithPrefixEmpty(a[c]["OGG sound"],"/file/");b.push({AAC:d?"":a[c]["AAC sound"],OGG:f?"":a[c]["OGG sound"],MP3:e?"":a[c]["MP3 sound"],isEmpty:e&&d&&f})}return{sounds:b}},loadSounds:function(a,b){var c=[];if(!buzz.isSupported()||
!a||!b)return c;for(var e=0;e<b;e++)e>a.length-1||a[e].isEmpty?c[e]=null:(c[e]=""!==a[e].MP3&&buzz.isMP3Supported()?new buzz.sound(a[e].MP3):""!==a[e].OGG&&buzz.isOGGSupported()?new buzz.sound(a[e].OGG):new buzz.sound(a[e].AAC),c[e].load());return c},convertFramesList:function(a,b,c){if(ModelValidationUtils.isStringEmpty(a))return{isError:!0,errorCode:"FL01"};var e=a.match(/[0-9a-zA-Z,-]+/);if(null===e||a.length!==e[0].length)return{isError:!0,errorCode:"FL02"};for(var e=[],a=a.split(","),d=0;d<a.length;d++){if(ModelValidationUtils.isStringEmpty(a[d]))return{isError:!0,
errorCode:"FL04"};if(-1!==a[d].search("-")){var f=a[d].split("-")[1],g=ModelValidationUtils.validateIntegerInRange(f,c,b);if(!g.isValid)return{isError:!0,errorCode:"FL05"};var i=a[d].split("-")[0],f=ModelValidationUtils.validateIntegerInRange(i,f.value,b);if(!f.isValid||f.value>g.value)return{isError:!0,errorCode:"FL05"};for(f=f.value;f<=g.value;f++)e.push(f)}else{g=ModelValidationUtils.validateIntegerInRange(a[d],c,b);if(!g.isValid)return{isError:!0,errorCode:"FL03"};e.push(g.value)}}e.sort();e=
ModelValidationUtils.removeDuplicatesFromArray(e);return{isError:!1,list:e}}}})(window);(function(d){d.StringUtils={replaceAll:function(a,b,c){b=b.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");return a.replace(RegExp(b,"g"),c)},startsWith:function(a,b){return a.match("^"+b)==b},endsWith:function(a,b){return-1!==a.indexOf(b,a.length-b.length)}}})(window);(function(d){d.TextParserProxy=function(a){if(null==a)return null;this.parser=a};d.TextParserProxy.prototype.parse=function(a){a=this.parser.parse(a);return StringUtils.replaceAll(a,"href='#'",'href="javascript:void(0)"')};d.TextParserProxy.prototype.connectLinks=function(a){return this.parser.connectLinks(a)};d.TextParserProxy.prototype.parseGaps=function(a){return this.parser.parseGaps(a)}})(window);(function(d){d.Internationalization={EASTERN_ARABIC:"ea",WESTERN_ARABIC:"wa",PERSO_ARABIC:"pa",getNumericals:function(a){var b={};b[d.Internationalization.WESTERN_ARABIC]={"0":"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"};b[d.Internationalization.EASTERN_ARABIC]={"0":"&#x0660",1:"&#x0661",2:"&#x0662",3:"&#x0663",4:"&#x0664",5:"&#x0665",6:"&#x0666",7:"&#x0667",8:"&#x0668",9:"&#x0669"};b[d.Internationalization.PERSO_ARABIC]={"0":"&#x06F0",1:"&#x06F1",2:"&#x06F2",3:"&#x06F3",4:"&#x06F4",
5:"&#x06F5",6:"&#x06F6",7:"&#x06F7",8:"&#x06F8",9:"&#x06F9"};return a in b?b[a]:b[d.Internationalization.WESTERN_ARABIC]},translate:function(a,b){for(var c=a.toString(),e="",h=d.Internationalization.getNumericals(b),f=0;f<c.length;f++)e+=h[+c.charAt(f)];return e}}})(window);(function(d){d.LoadedPromise=function(a,b){var c=[];$.each(b,function(b){var d=new $.Deferred,f=d.promise();a[b+"LoadedDeferred"]=d;a[b+"Loaded"]=f;c.push(f);a.getLoadedPromise=function(){var a=new $.Deferred,b=function(c,d){d==c.length?a.resolve():$.when(c[d]).then(function(){b(c,d+1)})};b(c,0);return a.promise()}})}})(window);
/**
 * Player Addons Commons library
 * @version 1.9.4
 * Components:
 * - Model Validation Utils
 * - Loading Screen
 * - DOM Operations
 * - States Serialization
 * - Watermark
 * - Commands
 * - Image Viewer (partial)
 * - Helpers
 * - Mobile Utils
 * - String Utils
 * - Internationalization
 * - Text Parser Proxy
 * - Loaded Promise
 */